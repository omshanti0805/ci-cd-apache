---

- name: Ansible copy directory to the remote server
  hosts: appserver1
  tasks:
  
  - name: Ansible Docker-Compose file to remote server
    copy:
      src: /mnt/data/jenkins/workspace/ansible-deploy/ansible/script/
      dest: /home/ubuntu/
      mode: a+w
      force: yes
    become: true

  
  - name: Docker Compose down
    docker_compose:
      project_src: /home/ubuntu/
      state: absent
    register: output
    become: true
  - debug:
      var: output

  - name: Docker Compose up
    docker_compose:
      project_src: /home/ubuntu/
      build: no
      state: present
    register: output
    become: true
  - debug:
      var: output

#  - name: Prune everything
#    docker_prune:
#      images: yes
#    become: yes
#    register: output
#  - debug:
#      var: output

  become: true

